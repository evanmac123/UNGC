- @title = 'Dashboard Overview'
%h2= @organization.name
%div{:class => "tab_container top_tabs"}
  %ul.tab_nav
    %li= link_to 'Overview', '#overview'
    %li= link_to 'Getting Started', '#getting_started'
    %li= link_to 'Contacts', '#contacts'
    %li= link_to 'Logo Requests', '#logos'
    %li= link_to @organization.cop_acronym.pluralize, '#cops'
    %li= link_to "Draft #{@organization.cop_acronym.pluralize}", '#cop_drafts'
    - if @organization.business?
      %li= link_to t("action_platform.labels.dashboard_tab"), "#action_platforms"
    %li= link_to 'Level of Engagement', '#level_of_engagement'

  #overview.tab_content
    %ul#contacts_tools{:class => "tools inline"}
      %li= link_to name_for_edit_link(current_contact), edit_admin_organization_path(@organization.id), :class => 'edit_large', :title => "Edit profile"

    %dl.left_column
      %h3 Organization Details
      %dt.first= display_id_type(@organization)
      %dd.first= @organization.id
      %dt Status
      %dd= full_organization_status(@organization)
      %dt Relationship Manager
      %dd= link_to @organization.participant_manager_name, "mailto:#{@organization.participant_manager_email}?subject=#{@organization.name}%20(ID: #{@organization.id})"
      %dt Participant since
      %dd= @organization.joined_on || 'n/a'
      %dt== #{@organization.cop_acronym} Due Date
      %dd= @organization.cop_due_on || 'n/a'
      %dt Organization Type
      %dd= @organization.organization_type_name
      - if @organization.company?
        %dt Ownership
        %dd
          = @organization.is_ft_500 ? 'FT 500' : nil
          = @organization.listing_status_name
      %dt Sector
      %dd= @organization.sector_name
      %dt Employees
      %dd= @organization.employees
      %dt Country
      %dd= @organization.country_name
      - unless @organization.url.blank?
        %dt Website
        %dd= link_to truncate(@organization.url, :length => 30), @organization.url
      - if @organization.commitment_letter?
        %dt Letter of Commitment
        %dd{:title => @organization.commitment_letter_file_name}= link_to truncate(@organization.commitment_letter_file_name, :length => 30), @organization.commitment_letter.url

    %dl.left_column
      %h3 Contact Information
      %dt.first Highest Level Executive
      %dd.first= render :partial => 'admin/organizations/contact_overview', :collection => @organization.contacts.ceos
      %dt Contact Point
      %dd= render :partial => 'admin/organizations/contact_overview', :collection => @organization.contacts.contact_points

    - if local_network_and_contact_exists?
      %dl.left_column
        %h3 Local Network #{@organization.local_network_name}
        %p Please contact your Local Network with any questions or concerns regarding your participation in the Global Compact.
        %dt.first Contact Person
        %dd.first
          = mail_to @organization.network_contact_person.email, @organization.network_contact_person.full_name_with_title
          %dt Profile
          %dd= popup_link_to "Local Network #{@organization.local_network.name}", dashboard_link_to_public_profile(@organization.local_network)

  #getting_started.tab_content
    %dl.left_column{:style => 'width: 100%;'}
      %dt.first Documents
      %dd.first
        %ul.document_list
          %li= popup_link_to 'Welcome Package', link_to_getting_started, class: :web
          %li= popup_link_to 'Welcome Letter from the Executive Director of the Global Compact', show_welcome_letter_admin_organization_path(@organization.id), class: :doc
          %li= link_to_local_network_welcome_letter_if_exists

      %dt Relationship Manager
      %dd
        %p
          = @organization.participant_manager_name
          %br/
          = link_to @organization.participant_manager_email, "mailto:#{@organization.participant_manager_email}?subject=#{@organization.name}%20(ID: #{@organization.id})"
          %br/
          = @organization.participant_manager_phone
        %p The Relationship Management team aims to enhance participant engagement by supporting and guiding participants through the broad landscape of initiatives, partnerships, resources and tools offered by the Global Compact. Additionally, they are able to support any technical queries that your organization may have. Please feel free to contact your Relationship Manager with any questions or concerns that you may have regarding your participation in the Global Compact.

      - if local_network_and_contact_exists?
        %dt
          Local Network
          %br/
          Contact Person
        %dd
          %p
            = @organization.network_contact_person.full_name_with_title
            %br/
            = mail_to @organization.network_contact_person.email
          %p Local Networks help facilitate the progress of companies (both local firms and subsidiaries of foreign corporations) engaged in the Global Compact, while creating opportunities for multi-stakeholder engagement and collective action. Local Networks deepen the learning experience for participants through their own activities and events and promote action in support of broader UN goals. Please contact your Local Network for support and information on engagement opportunities in your country and region.
          - if @organization.local_network_url.present?
            %ul.document_list
              %li= popup_link_to "Local Network #{@organization.local_network.name}", dashboard_link_to_public_profile(@organization.local_network), :class => 'web'

  #contacts.tab_content
    %ul#contacts_tools{:class => "tools inline"}
      %li= link_to 'New contact', new_admin_organization_contact_path(@organization.id), :class => 'new_user_large', :title => 'New Contact'
    %ul.items= render :partial => "admin/contacts/tabbed_contact", :collection => current_contact.organization.contacts

  - if @organization.pending_review? or @organization.in_review?
    %h3 Comments
    = link_to 'New comment', new_admin_organization_comment_path(@organization.id)
    %ul
      = render :partial => 'admin/comments/comment', :collection => @organization.comments

  - else
    #logos.tab_content
      - if @organization.delisted?
        = render :partial => 'admin/cops/expelled_note'
      - else
        = link_to 'New Logo Request', new_admin_organization_logo_request_path(current_contact.organization.id), :class => 'new_large', :id => 'new_logo_request'
      %table.dashboard_table#logos_dashboard_table
        %tr
          %th.last_updated Last updated on
          %th.title Purpose
          %th.status Status
          %th.age Days since last update
          %th.actions Actions
        = render :partial => 'admin/logo_requests/logo_request', :collection => current_contact.organization.logo_requests
    #cops.tab_content
      - unless @organization.can_submit_cop?
        = render :partial => 'admin/cops/expelled_note'
      - else
        = link_to "New #{@organization.cop_name}", cop_introduction_path, :class => 'new_large', :id => 'new_COP'

      %table.dashboard_table#cops_dashboard_table
        %tr
          %th.last_updated Published
          %th.title Title
          %th.status Status
          - if @organization.business_entity?
            %th.differentiation Differentiation
          %th.actions Actions
        = render :partial => 'admin/communication_on_progresses/communication_on_progress', :collection => current_contact.organization.communication_on_progresses.order("created_at DESC")

    #cop_drafts.tab_content
      = render :partial => 'admin/cops/drafts', locals: { drafts: current_contact.organization.communication_on_progresses.in_progress }

    #action_platforms.tab_content
      = render partial: "/admin/action_platform/landing"

    #level_of_engagement.tab_content
      = render partial: "/admin/level_of_participations/landing"
