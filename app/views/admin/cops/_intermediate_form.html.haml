%div{:class => "tab_container left_tabs"}
  %ul.tab_nav
    %li <a href="#basic">General Information</a>
    %li#submit_tab{:style => 'display:none'} <a href="#finish">Submit your COP</a>
  
  #basic.tab_content
    - if form.error_messages.present?
      %p
        %strong Please select a COP file for upload. If you have provided a website link, it should be in the format http://www.company.com/

    %fieldset
      %fieldset
        %legend
          %span The Communication on Progress is in the following format:
        - CommunicationOnProgress::FORMAT.each do |key, value|
          %label
            = form.radio_button :format, key
            = value
            
      #grace_letter_fields{:style => css_display_style(@communication_on_progress.is_grace_letter?)}
        %fieldset
          %legend
            %span Please upload your "Grace Letter"
          = render :partial => 'cop_file', :locals => {:cop_file => CopFile.new(:attachment_type => CopFile::TYPES[:grace_letter])}
                  
      #non_grace_letter_fields{:style => 'display: none'}
        #cop_attachments{:style => 'display: block'}
          %fieldset
            %legend
              %span Upload the COP as a PDF file
            = text_partial('b')
            = render :partial => 'cop_file', :locals => {:cop_file => CopFile.new(:attachment_type => CopFile::TYPES[:cop])}
        
        #web_cop_attachments{:style => 'display: block'}
          %fieldset
            %legend
              %span Provide a link to your web-based COP. The link should be in the format 'http://www.company.com/'
            = render :partial => 'cop_link', :locals => {:cop_link => CopLink.new(:attachment_type => CopFile::TYPES[:cop])}
              
        #own_company_questions{:style => 'display: block'}
          %fieldset
            %legend
              %span What is the time period covered by your COP?
            %ul.date_select
              %li Start date
              = form.date_select :starts_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year, :default => {:year => current_year-1} }
            %ul.date_select
              %li End date
              = form.date_select :ends_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year}
        
          %fieldset
            %legend
              %span Does your COP contain a statement by the CEO (or equivalent) expressing continued support for the Global Compact and renewing your company's ongoing commitment to the initiative and its principles.
            = true_or_false_field(form, :include_continued_support_statement)

          #include_continued_support_statement{:style => 'display: none'}
            %fieldset
              %legend
                %span
                  Does your COP contain description of actions, and when relevant policies, related to the following issue areas?
                  %em Please answer 'Yes' or 'No' for each of the four issue areas.

              %span{:class => 'radio_label'}
                Human Rights
                = true_or_false_field(form, :references_human_rights, :class => 'score')
              %span{:class => 'radio_label'}
                Labour
                = true_or_false_field(form, :references_labour, :class => 'score')
              %span{:class => 'radio_label'}
                Environment
                = true_or_false_field(form, :references_environment, :class => 'score')
              %span{:class => 'radio_label'}
                Anti-Corruption
                = true_or_false_field(form, :references_anti_corruption, :class => 'score')

            %fieldset
              %legend
                %span Does your COP identify targets, define performance indicators and measure outcomes?
              = true_or_false_field(form, :include_measurement, :class => 'score')

  #finish.tab_content
    Please click 'Submit' to complete the COP submission process.
    = text_partial('a')
    - for letter in ('l'..'p')
      = text_partial(letter)
    = hidden_field_tag("communication_on_progress[additional_questions]", 0)
    = submit_tag 'Submit', :class => "button", :id => "finish"

= organization_javascript_vars @organization
= javascript_tag "var work_in_progress = false;"