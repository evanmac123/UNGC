- if form.error_messages.present?
  %div{:class => 'flash error'}
    Please select a PDF file for upload. If you have provided a website link, it should begin with 'http://'

    / Strategy, Governance and Engagement (Strategy)
    / UN Goals and Issues (UN Goals)
    / Human Rights Implementation (Human Rights)
    / Labour Rights and Principles Implementation (Labour)
    / Environmental Stewardship Implementation (Environment)
    / Anti-Corruption Implementation (Anti-Corruption)
    / Value Chain Implementation (Value Chain)
    / Verification and Transparency (Verification)


%div{:class => "tab_container left_tabs"}
  %ul.tab_nav
    %li <a id="basic_link" href="#basic">General Information</a>
       
    %li#strategy_governance_tab{:class => 'additional_questions'} <a href="#strategy_additional_questions">&nbsp;&raquo;&nbsp;Strategy</a>

    %li#un_goals_tab{:class => 'additional_questions'} <a href="#un_goals_additional_questions">&nbsp;&raquo;&nbsp;UN Goals</a>

    %li#human_rights_tab{:class => 'additional_questions'} <a href="#human_rights_additional_questions">&nbsp;&raquo;&nbsp;Human Rights</a>
    
    %li#labour_tab{:class => 'additional_questions'}  <a href="#labour_additional_questions">&nbsp;&raquo;&nbsp;Labour</a>

    %li#environment_tab{:class => 'additional_questions'}  <a href="#environment_additional_questions">&nbsp;&raquo;&nbsp;Environment</a>

    %li#anti_corruption_tab{:class => 'additional_questions'}  <a href="#anti_corruption_additional_questions">&nbsp;&raquo;&nbsp;Anti-Corruption</a>

    %li#value_chain_tab{:class => 'additional_questions'} <a href="#value_chain_additional_questions">&nbsp;&raquo;&nbsp;Value Chain</a>

    %li#verification_disclosure_tab{:class => 'additional_questions'} <a href="#verification_additional_questions">&nbsp;&raquo;&nbsp;Verification</a>

    %li#notable_tab{:style => css_display_style(@communication_on_progress.notable_program?)} <a href="#notable_questions">Notable Program</a>

    %li#submit_tab{:style => "#{css_display_style(@submitted)}"} <a id="submit_link" href="#finish">Submit your COP</a>
  
  #basic.tab_content
    %div.principles
      %h3 General Information
    %fieldset
      %fieldset
        %legend
          %span About the self-assessment
        %p{:class => 'question_text'}
          Using this online questionnaire you will have the opportunity to assess what commonly accepted best practice your COP describes under each of the 24 GC Advanced criteria, in the following areas:

        %ul.bulleted{:style => "float: left; margin-left: 1em; margin-right: 3em;"}
          %li Strategy, Governance and Engagement
          %li UN goals and issues
          %li Implementation of Global Compact principles
        %ul.bulleted{:style => "margin-bottom: 2em;"}
          %li Value chain implementation
          %li Verification and transparency
        %p{:style => 'display: block; clear both; margin: 3em 0em 2em 2em;'}
        %p At the end of the questionnaire, you will be asked to confirm that, based on the self-assessment, your company meets all 24 GC Advanced criteria and that the COP describes implementation of all 24 criteria and relevant best practices selected in the self-assessment.
        %ul.bulleted
          %li If you confirm, your company and the COP will automatically qualify for the GC Advanced level and the results of the self assessment will be made public on the Global Compact website, alongside your COP.
          %li
            If you cannot confirm, the COP will be submitted but the company will not qualify for the GC Advanced level. However, the results of the self assessment will be made public on the Global Compact website, alongside the COP, to improve the searchability and analysis of the COPs and underlying performance.
            %em Note: If you do not want the results to be publicly displayed, please use the regular COP submission process.        

    = render :partial => 'cop_title_field', :locals => {:form => form, :current_year => current_year}

    %fieldset
      %fieldset
        %legend
          %span The Communication on Progress is in the following format:
        - CommunicationOnProgress::FORMAT.each do |key, value|
          %label
            = form.radio_button :format, key
            = value
    
      #non_grace_letter_fields{:style => "#{css_display_style(@submitted)}"}
              
        #own_company_questions{:style => 'display: block'}
          %fieldset
            %legend
              %span What is the time period covered by your COP?
            %ul.date_select
              %li Start date
              = form.date_select :starts_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year, :default => {:year => current_year-1} }
            %ul.date_select
              %li End date
              = form.date_select :ends_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year}
        
          %fieldset
            %legend
              %span Does your COP contain a statement by the CEO (or equivalent) expressing continued support for the Global Compact and renewing your company's ongoing commitment to the initiative and its principles?
            = true_or_false_field(form, :include_continued_support_statement)

          #include_continued_support_statement{:style => css_display_style(@submitted)}
            = render :partial => 'cop_issue_areas_form', :locals => {:form => form}
            
            %fieldset
              %legend
                %span Does your COP identify targets, define performance indicators and measure outcomes?
              = true_or_false_field(form, :include_measurement, :class => 'score')
              
          #method_shared_with_stakeholders{:style => css_display_style(@submitted)}
            %fieldset
              %fieldset
                %legend
                  %span How does your organisation share its COP with stakeholders?
                - CommunicationOnProgress::METHOD.each do |key, value|
                  %label
                    = form.radio_button :method_shared, key
                    = value
            
  / - PrincipleArea::FILTERS.each_pair do |key, value|
  /   %div.tab_content{:id => "#{key}_additional_questions"}
  /     %h3
  /       %span{:class => "#{issue_area_colour_for(value)}" }= value
  /     %fieldset= cop_questions_for @communication_on_progress, :additional, key

  %div.tab_content{:id => "strategy_additional_questions"}
    %h3 Strategy, Governance and Engagement
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :strategy

  %div.tab_content{:id => "un_goals_additional_questions"}
    %h3 UN Goals and Issues
    %p For the following criterion, please check the best practices you have implemented and discussed in your COP.
    %div{:class => 'hint_toggle'} About this section...
    %div{:class => 'hint_text', :style => 'display: none;'}
      %div{:style => 'margin-left: 2em;'}
        %p "Broader UN Goals and Issues" refers to an array of global issues - based on the most acute or chronic global challenges - including: 
        %ul{:style => "float: left; margin-left: 1em; margin-right: 3em;"}
          %li Peace & Security 
          %li Millennium Development Goals 
          %li Human Rights 
          %li Children's Rights
          %li Gender Equality

        %ul{:style => "float: left; margin-right: 4em;"}
          %li Health
          %li Education
          %li Humanitarian Assistance
          %li Migration
          %li Food Security
        
        %ul{:style => "margin-bottom: 2em;"}
          %li Sustainable Ecosystems and Biodiversity
          %li Climate Change Mitigation and Adaptation
          %li Water Security and Sanitation
          %li Employment and Decent Working Conditions
          %li Anti-Corruption
       
      %p{:style => 'display: block; clear both; margin-left: 2em;'}
        For a list of further Global Issues that are relevant to the work of the UN as well as business, please refer to
        = popup_link_to 'business.un.org','http://business.un.org/en/browse/global_issues' 
          
    %fieldset= cop_questions_for @communication_on_progress, :un_goals

  %div.tab_content{:id => "human_rights_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('human_rights')}" } Human Rights Implementation
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :human_rights

  %div.tab_content{:id => "labour_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('labour')}" } Labour Principles Implementation
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :labour

  %div.tab_content{:id => "environment_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('environment')}" } Environmental Stewardship Implementation
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :environment

  %div.tab_content{:id => "anti_corruption_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('anti_corruption')}" } Anti-Corruption Implementation
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :anti_corruption

  %div.tab_content{:id => "value_chain_additional_questions"}
    %h3 Value Chain Implementation
    %p For the following criterion, please check the best practices you have implemented and discussed in your COP.
    %div{:class => 'hint_toggle'} About this section...
    %div{:class => 'hint_text', :style => 'display: none;'}
      %p{:style => 'padding-left: 2em;'} The term 'value chain', for purposes of this self-assessment, refers to an organization's upstream business partners (including suppliers and subcontractors) and downstream business partners (e.g. for transport of finished products).
      
    %fieldset= cop_questions_for @communication_on_progress, :value_chain

  %div.tab_content{:id => "verification_additional_questions"}
    %h3 Verification and Transparency
    %p For each of the following criteria, please check the best practices you have implemented and discussed in your COP.
    %fieldset= cop_questions_for @communication_on_progress, :verification

  #finish.tab_content
    %fieldset
      #cop_attachments{:style => 'display: block'}
        %fieldset
          %legend
            %span Required: upload the COP as a PDF file
          = text_partial('b')
          = render :partial => 'cop_files_form'
  
    %fieldset
      #web_cop_attachments{:style => 'display: block'}
        %fieldset
          %legitgend
            %span Optional: provide a link to your web-based COP. The link should be in the format 'http://www.company.com/'
          = render :partial => 'cop_link', :locals => {:cop_link => CopLink.new(:attachment_type => CopFile::TYPES[:cop])}

    %fieldset
      #best_practices{:style => 'display: block'}
        %fieldset
          %legend
            %span Optional: Other established or emerging best practices
          %p Please use the text box below to share with the Global Compact Office any other established or emerging best practices.
          = form.text_area :description, :class => 'cop_answer'
 
    %fieldset
      #confirmation{:style => 'display: block'}
        %fieldset
          %legend
            %span Confirmation
          %p Before submitting this COP and the self-assessment, please confirm that your company meets all 24 criteria for the GC Advanced level and that the COP describes implementation of all criteria and relevant best practices selected in the self-assessment.
          
          %p= true_or_false_field form, :meets_advanced_criteria
          %br
          %br
          %p{:style => 'padding-top: 20px;'}
            %em Note: The self-assessment will be made public on the Global Compact website, alongside the COP, to improve the searchability and analysis of the COPs and underlying performance. If you do not want the results to be publicly displayed, please do not proceed with this submission and use the regular COP submission process instead.

    %fieldset
      #signature{:style => 'display: block'}
        %fieldset
          %legend
            %span Contact Information
          %p Optional: To facilitate stakeholder engagement, you may publish the contact information of a representative from your company.
          = form.text_area :contact_name, :class => 'cop_answer', :value => current_user.contact_info

    = render :partial => 'submit_cop'

= organization_javascript_vars @organization
= javascript_tag "var work_in_progress = false;"
= form_submitted?(@submitted)