- if form.error_messages.present?
  %div{:class => 'flash error'}
    Please select a PDF file for upload. If you have provided a website link, it should begin with 'http://'

    / Strategy, Governance and Engagement (Strategy)
    / UN Goals and Issues (UN Goals)
    / Human Rights Implementation (Human Rights)
    / Labour Rights and Principles Implementation (Labour)
    / Environmental Stewardship Implementation (Environment)
    / Anti-Corruption Implementation (Anti-Corruption)
    / Value Chain Implementation (Value Chain)
    / Verification and Transparency (Verification)


%div{:class => "tab_container left_tabs"}
  %ul.tab_nav
    %li <a id="basic_link" href="#basic">General Information</a>
       
    %li#strategy_governance_tab{:class => 'additional_questions'} <a href="#strategy_additional_questions">&nbsp;&raquo;&nbsp;Strategy</a>

    %li#un_goals_tab{:class => 'additional_questions'} <a href="#un_goals_additional_questions">&nbsp;&raquo;&nbsp;UN Goals</a>

    %li#human_rights_tab{:class => 'additional_questions'} <a href="#human_rights_additional_questions">&nbsp;&raquo;&nbsp;Human Rights</a>
    
    %li#labour_tab{:class => 'additional_questions'}  <a href="#labour_additional_questions">&nbsp;&raquo;&nbsp;Labour</a>

    %li#environment_tab{:class => 'additional_questions'}  <a href="#environment_additional_questions">&nbsp;&raquo;&nbsp;Environment</a>

    %li#anti_corruption_tab{:class => 'additional_questions'}  <a href="#anti_corruption_additional_questions">&nbsp;&raquo;&nbsp;Anti-Corruption</a>

    %li#value_chain_tab{:class => 'additional_questions'} <a href="#value_chain_additional_questions">&nbsp;&raquo;&nbsp;Value Chain</a>

    %li#verification_disclosure_tab{:class => 'additional_questions'} <a href="#verification_additional_questions">&nbsp;&raquo;&nbsp;Verification</a>

    %li#notable_tab{:style => css_display_style(@communication_on_progress.notable_program?)} <a href="#notable_questions">Notable Program</a>

    %li#submit_tab{:style => "#{css_display_style(@submitted)}"} <a id="submit_link" href="#finish">Submit your COP</a>
  
  #basic.tab_content
    %div.principles
      %h3 General Information
    %fieldset
      %fieldset
        %legend
          %span Eligibility for the GC Advanced level
        %p{:class => 'question_text'}
          The purpose of this online questionnaire is to assess eligibility for the GC Advanced level by confirming that

        %p 1. Your company meets 24 Advanced Criteria in the following areas:
        %ul.bulleted
          %li Strategy, Governance and Engagement
          %li UN goals and issues
          %li Implementation of Global Compact principles
          %li Value chain implementation
          %li Verification and disclosure
        %br
        %p
          %em Note: A criterion is "met" if a business participant believes it has, in good faith, implemented best practices that are relevant for its context of operation. For each criterion, the Global Compact provides examples of commonly accepted best practices that companies are encouraged to implement to meet the criteria.  (See Advanced Criteria and Associated Best practices (pdf)).
        %p 2. The Communication on Progress (COP) demonstrates implementation of all 24 criteria and associated best practices
        %p 3. Provide the public with a detailed self-assessment of the content of the COP to facilitate accessibility of information.
        
    %fieldset
      %fieldset
        %legend
          %span The Communication on Progress is in the following format:
        - CommunicationOnProgress::FORMAT.each do |key, value|
          %label
            = form.radio_button :format, key
            = value
    
      #non_grace_letter_fields{:style => "#{css_display_style(@submitted)}"}
              
        #own_company_questions{:style => 'display: block'}
          %fieldset
            %legend
              %span What is the time period covered by your COP?
            %ul.date_select
              %li Start date
              = form.date_select :starts_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year, :default => {:year => current_year-1} }
            %ul.date_select
              %li End date
              = form.date_select :ends_on, {:order => [:month, :year], :start_year => 2000, :end_year => current_year}
        
          %fieldset
            %legend
              %span Does your COP contain a statement by the CEO (or equivalent) expressing continued support for the Global Compact and renewing your company's ongoing commitment to the initiative and its principles?
            = true_or_false_field(form, :include_continued_support_statement)

          #include_continued_support_statement{:style => css_display_style(@submitted)}
            = render :partial => 'cop_issue_areas_form', :locals => {:form => form}
            
            %fieldset
              %legend
                %span Does your COP identify targets, define performance indicators and measure outcomes?
              = true_or_false_field(form, :include_measurement, :class => 'score')
              
          #method_shared_with_stakeholders{:style => css_display_style(@submitted)}
            %fieldset
              %fieldset
                %legend
                  %span How does your organisation share its COP with stakeholders?
                - CommunicationOnProgress::METHOD.each do |key, value|
                  %label
                    = form.radio_button :method_shared, key
                    = value
            
  / - PrincipleArea::FILTERS.each_pair do |key, value|
  /   %div.tab_content{:id => "#{key}_additional_questions"}
  /     %h3
  /       %span{:class => "#{issue_area_colour_for(value)}" }= value
  /     %fieldset= cop_questions_for @communication_on_progress, :additional, key

  %div.tab_content{:id => "strategy_additional_questions"}
    %h3 Strategy, Governance and Engagement
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :strategy

  %div.tab_content{:id => "un_goals_additional_questions"}
    %h3 UN Goals and Issues
    %p For the following criterion, please check the best practices you have implemented.    
    %div{:class => 'hint_toggle'} About this section...
    %div{:class => 'hint_text', :style => 'display: none;'}
      %div{:style => 'margin-left: 2em;'}
        %p "Broader UN Goals and Issues" refers to an array of global issues - based on the most acute or chronic global challenges - including: 
        %ul{:style => "float: left; margin-left: 1em; margin-right: 3em;"}
          %li Peace & Security 
          %li Millennium Development Goals 
          %li Human Rights 
          %li Children's Rights
          %li Gender Equality

        %ul{:style => "float: left; margin-right: 4em;"}
          %li Health
          %li Education
          %li Humanitarian Assistance
          %li Migration
          %li Food Security
        
        %ul{:style => "margin-bottom: 2em;"}
          %li Sustainable Ecosystems and Biodiversity
          %li Climate Change Mitigation and Adaptation
          %li Water Security and Sanitation
          %li Employment and Decent Working Conditions
          %li Anti-Corruption
       
      %p{:style => 'display: block; clear both; margin-left: 2em;'}
        For a list of further Global Issues that are relevant to the work of the UN as well as business, please refer to
        = popup_link_to 'business.un.org','http://business.un.org/en/browse/global_issues' 
          
    %fieldset= cop_questions_for @communication_on_progress, :un_goals

  %div.tab_content{:id => "human_rights_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('human_rights')}" } Human Rights Implementation
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :human_rights

  %div.tab_content{:id => "labour_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('labour')}" } Labour Principles Implementation
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :labour

  %div.tab_content{:id => "environment_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('environment')}" } Environmental Stewardship Implementation
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :environment

  %div.tab_content{:id => "anti_corruption_additional_questions"}
    %h3
      %span{:class => "#{issue_area_colour_for('anti_corruption')}" } Anti-Corruption Implementation
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :additional, :anti_corruption

  %div.tab_content{:id => "value_chain_additional_questions"}
    %h3 Value Chain Implementation
    %p For the following criterion, please check the best practices you have implemented.
    %div{:class => 'hint_toggle'} About this section...
    %div{:class => 'hint_text', :style => 'display: none;'}
      %p{:style => 'padding-left: 2em;'} The term 'value chain', for purposes of this self-assessment, refers to an organization's upstream business partners (including suppliers and subcontractors) and downstream business partners (e.g. for transport of finished products).
      
    %fieldset= cop_questions_for @communication_on_progress, :value_chain

  %div.tab_content{:id => "verification_additional_questions"}
    %h3 Verification and Transparency
    %p For each of the following criteria, please check the best practices you have implemented.
    %fieldset= cop_questions_for @communication_on_progress, :verification

  #finish.tab_content
    %fieldset
      #cop_attachments{:style => 'display: block'}
        %fieldset
          %legend
            %span Required: upload the COP as a PDF file
          = text_partial('b')
          = render :partial => 'cop_files_form'
  
    %fieldset
      #web_cop_attachments{:style => 'display: block'}
        %fieldset
          %legend
            %span Optional: provide a link to your web-based COP. The link should be in the format 'http://www.company.com/'
          = render :partial => 'cop_link', :locals => {:cop_link => CopLink.new(:attachment_type => CopFile::TYPES[:cop])}

    %fieldset
      #signature{:style => 'display: block'}
        %fieldset
          %legend
            %span Virtual signature confirming that the organization meets all 24 above-listed criteria
          %h4
            I,
            = form.text_field :contact_name, :value => current_user.full_name_with_title, :style => 'border: 0px; border-bottom: 1px dashed #000; margin: 0px;', :title => "Click to edit the name"
            believe, in good faith, that the company I represent meets all 24 criteria for the Advanced level, as described in this self-assessment, and that our COP substantiates our self-assessment.
          %p  Note: Validating this document by signature indicates good faith by the person who signs that the organisation has fulfilled the 24 above criteria. The person's signature is for accountability purposes only, and does not create any legal liability for either the person signing or for the organisation.
          %p To establish credibility among stakeholders and other interested parties, the Global Compact recommends that the above signature be completed by an executive of the company or the company's officer in charge of corporate sustainability.      
    %p= submit_tag 'Submit', :class => "button", :id => "finish"

= organization_javascript_vars @organization
= javascript_tag "var work_in_progress = false;"
= form_submitted?(@submitted)